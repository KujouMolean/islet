From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Molean <cnmolean@gmail.com>
Date: Sun, 14 Aug 2022 18:18:51 +0800
Subject: [PATCH] disable natural spawn for region


diff --git a/src/main/java/net/minecraft/server/level/ServerLevel.java b/src/main/java/net/minecraft/server/level/ServerLevel.java
index 46ed5013f860e4684e94579cc49dd4a1df213aba..970083277eb47881e3c345a49d5a9e14754056d4 100644
--- a/src/main/java/net/minecraft/server/level/ServerLevel.java
+++ b/src/main/java/net/minecraft/server/level/ServerLevel.java
@@ -6,6 +6,7 @@ import com.google.common.collect.Lists;
 import com.mojang.datafixers.DataFixer;
 import com.mojang.datafixers.util.Pair;
 import com.mojang.logging.LogUtils;
+import com.molean.region.modifier.NaturalSpawningDisableManager;
 import com.molean.region.monitor.RegionMonitor;
 import com.molean.region.monitor.RegionMonitorManager;
 import com.molean.region.monitor.RegionPos;
diff --git a/src/main/java/net/minecraft/world/level/NaturalSpawner.java b/src/main/java/net/minecraft/world/level/NaturalSpawner.java
index 36e920818ab33e89e825aefdce7b6067ddc6755e..e6765ffcb72bbb8f68d835ffb91cf854979b24f2 100644
--- a/src/main/java/net/minecraft/world/level/NaturalSpawner.java
+++ b/src/main/java/net/minecraft/world/level/NaturalSpawner.java
@@ -1,6 +1,7 @@
 package net.minecraft.world.level;
 
 import com.mojang.logging.LogUtils;
+import com.molean.region.modifier.NaturalSpawningDisableManager;
 import com.molean.region.monitor.RegionMonitor;
 import com.molean.region.monitor.RegionMonitorManager;
 import com.molean.region.monitor.RegionPos;
@@ -134,6 +135,9 @@ public final class NaturalSpawner {
     }
 
     public static void spawnForChunk(ServerLevel world, LevelChunk chunk, NaturalSpawner.SpawnState info, boolean spawnAnimals, boolean spawnMonsters, boolean rareSpawn) {
+        if (NaturalSpawningDisableManager.INSTANCE.isRegionNaturalSpawningDisabled(new RegionPos(chunk.getPos().getRegionX(), chunk.getPos().getRegionZ()))) {
+            return;
+        }
         world.getProfiler().push("spawner");
         world.timings.mobSpawn.startTiming(); // Spigot
         MobCategory[] aenumcreaturetype = NaturalSpawner.SPAWNING_CATEGORIES;
